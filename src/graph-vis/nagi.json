{"paragraphs":[{"text":"import scala.util.parsing.json.JSON\n\ncase class Movie(\n    id: String,\n    title: String,\n    release_date: String,\n    genres: Seq[String],\n    adult: String,\n    popularity: String,\n    rating: String,\n    nbr_votes: String,\n    budget: String,\n    revenue: String,\n    duration: String,\n    url: String,\n    reviews: Option[Seq[String]],\n    popularity_from_reviews: Option[String]\n)\n\ndef parseJSON(s: String): Map[String, Any] = JSON.parseFull(s).get.asInstanceOf[Map[String, Any]]\n\ndef parseMovie(s : String): Option[Movie] = {\n    val json = parseJSON(s)\n    Some(Movie(\n        json(\"id\").toString,\n        json(\"title\").toString,\n        json(\"release_date\").toString,\n        Seq(json(\"genres\").toString),\n        json(\"adult\").toString,\n        json(\"popularity\").toString,\n        json(\"rating\").toString,\n        json(\"nbr_votes\").toString,\n        json(\"budget\").toString,\n        json(\"revenue\").toString,\n        json(\"duration\").toString,\n        json(\"url\").toString,\n        Some(Seq(json(\"reviews\").toString)),\n        Some(json(\"popularity_from_reviews\").toString)))\n}\n\n\n","user":"anonymous","dateUpdated":"2017-07-10T18:14:08+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499700821463_1980779097","id":"20170709-193413_275003073","dateCreated":"2017-07-10T17:33:41+0200","dateStarted":"2017-07-10T18:14:08+0200","dateFinished":"2017-07-10T18:14:09+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3064"},{"text":"val hdfs_path = \"/Users/Najj/Downloads/HDFS/\"\n\nval movies_str = sc.textFile(hdfs_path + \"[0-9]*/part-[0-9]*\")\n\nval movies = movies_str.flatMap(parseMovie)\n\n// convert to DataFrame and create temporal table\nmovies.toDF().registerTempTable(\"movies\")","user":"anonymous","dateUpdated":"2017-07-10T17:35:52+0200","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499700821464_1978855352","id":"20170709-205800_369947220","dateCreated":"2017-07-10T17:33:41+0200","dateStarted":"2017-07-10T17:35:52+0200","dateFinished":"2017-07-10T17:35:54+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3065"},{"text":"%sql \nselect title, popularity_from_reviews\nfrom movies\norder by popularity_from_reviews desc\n-- limit 25\n","user":"anonymous","dateUpdated":"2017-07-10T18:15:21+0200","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499700821465_1978470604","id":"20170709-210610_1639257673","dateCreated":"2017-07-10T17:33:41+0200","dateStarted":"2017-07-10T18:15:22+0200","dateFinished":"2017-07-10T18:15:23+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3066"},{"text":"%sql\nselect Avg(popularity_from_reviews), genres\nfrom movies\ngroup by genres","user":"anonymous","dateUpdated":"2017-07-10T18:00:19+0200","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499700821466_1979624850","id":"20170710-101531_1991958473","dateCreated":"2017-07-10T17:33:41+0200","dateStarted":"2017-07-10T18:00:19+0200","dateFinished":"2017-07-10T18:06:51+0200","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3067"},{"text":"%sql\nselect budget, popularity_from_reviews\nfrom movies\nwhere budget > 0\norder by budget desc\n-- limit 25","user":"anonymous","dateUpdated":"2017-07-10T18:16:30+0200","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499702419526_-9431729","id":"20170710-180019_1407557778","dateCreated":"2017-07-10T18:00:19+0200","dateStarted":"2017-07-10T18:15:58+0200","dateFinished":"2017-07-10T18:15:58+0200","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3068"},{"text":"%sql\nselect popularity_from_reviews, revenue\nfrom movies\norder by popularity_from_reviews desc\n-- limit 25\n","user":"anonymous","dateUpdated":"2017-07-10T18:18:18+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499703460290_-137864006","id":"20170710-181740_927905461","dateCreated":"2017-07-10T18:17:40+0200","dateStarted":"2017-07-10T18:18:18+0200","dateFinished":"2017-07-10T18:19:32+0200","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3069"},{"text":"%sql\nselect Avg(popularity_from_reviews), duration\nfrom movies\ngroup by duration\n-- limit 25","user":"anonymous","dateUpdated":"2017-07-10T18:16:50+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499703137189_-414004803","id":"20170710-181217_42336475","dateCreated":"2017-07-10T18:12:17+0200","dateStarted":"2017-07-10T18:16:50+0200","dateFinished":"2017-07-10T18:18:21+0200","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3070"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2017-07-10T18:16:50+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1499703410493_-998455351","id":"20170710-181650_564102704","dateCreated":"2017-07-10T18:16:50+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3071"}],"name":"bakht_a-spark","id":"2CQ5Z7K2M","angularObjects":{"2CPVWRGCS:shared_process":[],"2CMS9YXZ1:shared_process":[],"2CPR9CCP1:shared_process":[],"2CM6PJVSH:shared_process":[],"2CQKJDCHC:shared_process":[],"2CQ4RZ7S6:shared_process":[],"2CPNV4ZPJ:shared_process":[],"2CPJ6CXM6:shared_process":[],"2CQNFKE2H:shared_process":[],"2CNK42DTM:shared_process":[],"2CNX7544A:shared_process":[],"2CMMJTT37:shared_process":[],"2CNWZ6HKT:shared_process":[],"2CMBGACGN:shared_process":[],"2CMV3FRR7:shared_process":[],"2CQ2MG6SJ:shared_process":[],"2CQDGJGYT:shared_process":[],"2CMYUPDHS:shared_process":[],"2CQJCDDRQ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}